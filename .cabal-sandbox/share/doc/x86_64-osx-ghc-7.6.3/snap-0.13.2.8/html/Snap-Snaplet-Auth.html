<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Snap.Snaplet.Auth</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Snap-Snaplet-Auth.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">snap-0.13.2.8: Top-level package for the Snap Web Framework</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Snap.Snaplet.Auth</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Higher Level Handler Functions
</a></li><li><a href="#g:2">Lower Level Functions
</a></li><li><a href="#g:3">Types
</a></li><li><a href="#g:4">Other Utilities
</a></li><li><a href="#g:5">Handlers
</a></li><li><a href="#g:6">Splice helpers
</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module contains all the central authentication functionality.
</p><p>It exports a number of high-level functions to be used directly in your
 application handlers.
</p><p>We also export a number of mid-level functions that should be helpful when
 you are integrating with another way of confirming the authentication of
 login requests.
</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:createUser">createUser</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:usernameExists">usernameExists</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:saveUser">saveUser</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:destroyUser">destroyUser</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</li><li class="src short"><a href="#v:loginByUsername">loginByUsername</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:loginByRememberToken">loginByRememberToken</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:forceLogin">forceLogin</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> ())</li><li class="src short"><a href="#v:logout">logout</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</li><li class="src short"><a href="#v:currentUser">currentUser</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:isLoggedIn">isLoggedIn</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:markAuthSuccess">markAuthSuccess</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:markAuthFail">markAuthFail</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:checkPasswordAndLogin">checkPasswordAndLogin</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><span class="keyword">data</span>  <a href="#t:AuthManager">AuthManager</a> b = <span class="keyword">forall</span> r . <a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> r =&gt; <a href="#v:AuthManager">AuthManager</a> {<ul class="subs"><li><a href="#v:backend">backend</a> :: r</li><li><a href="#v:session">session</a> :: <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b <a href="Snap-Snaplet-Session-SessionManager.html#t:SessionManager">SessionManager</a></li><li><a href="#v:activeUser">activeUser</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></li><li><a href="#v:minPasswdLen">minPasswdLen</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:rememberCookieName">rememberCookieName</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:rememberPeriod">rememberPeriod</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:siteKey">siteKey</a> :: <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/clientsession-0.9.0.3/html/Web-ClientSession.html#t:Key">Key</a></li><li><a href="#v:lockout">lockout</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a>)</li><li><a href="#v:randomNumberGenerator">randomNumberGenerator</a> :: <a href="Snap-Snaplet-Session-Common.html#t:RNG">RNG</a></li></ul>}</li><li class="src short"><span class="keyword">class</span>  <a href="#t:IAuthBackend">IAuthBackend</a> r  <span class="keyword">where</span><ul class="subs"><li><a href="#v:save">save</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li><a href="#v:lookupByUserId">lookupByUserId</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li><a href="#v:lookupByLogin">lookupByLogin</a> :: r -&gt; <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li><a href="#v:lookupByRememberToken">lookupByRememberToken</a> :: r -&gt; <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li><a href="#v:destroy">destroy</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:AuthSettings">AuthSettings</a>  = <a href="#v:AuthSettings">AuthSettings</a> {<ul class="subs"><li><a href="#v:asMinPasswdLen">asMinPasswdLen</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:asRememberCookieName">asRememberCookieName</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:asRememberPeriod">asRememberPeriod</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:asLockout">asLockout</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a>)</li><li><a href="#v:asSiteKey">asSiteKey</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:FilePath">FilePath</a></li></ul>}</li><li class="src short"><a href="#v:defAuthSettings">defAuthSettings</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthSettings">AuthSettings</a></li><li class="src short"><span class="keyword">data</span>  <a href="#t:AuthUser">AuthUser</a>  = <a href="#v:AuthUser">AuthUser</a> {<ul class="subs"><li><a href="#v:userId">userId</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></li><li><a href="#v:userLogin">userLogin</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></li><li><a href="#v:userEmail">userEmail</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></li><li><a href="#v:userPassword">userPassword</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></li><li><a href="#v:userActivatedAt">userActivatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userSuspendedAt">userSuspendedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userRememberToken">userRememberToken</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></li><li><a href="#v:userLoginCount">userLoginCount</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:userFailedLoginCount">userFailedLoginCount</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></li><li><a href="#v:userLockedOutUntil">userLockedOutUntil</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userCurrentLoginAt">userCurrentLoginAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userLastLoginAt">userLastLoginAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userCurrentLoginIp">userCurrentLoginIp</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:userLastLoginIp">userLastLoginIp</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li><a href="#v:userCreatedAt">userCreatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userUpdatedAt">userUpdatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userResetToken">userResetToken</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></li><li><a href="#v:userResetRequestedAt">userResetRequestedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></li><li><a href="#v:userRoles">userRoles</a> :: [<a href="Snap-Snaplet-Auth.html#t:Role">Role</a>]</li><li><a href="#v:userMeta">userMeta</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/unordered-containers-0.2.3.0/doc/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:Value">Value</a></li></ul>}</li><li class="src short"><a href="#v:defAuthUser">defAuthUser</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></li><li class="src short"><span class="keyword">newtype</span>  <a href="#t:UserId">UserId</a>  = <a href="#v:UserId">UserId</a> {<ul class="subs"><li><a href="#v:unUid">unUid</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></li></ul>}</li><li class="src short"><span class="keyword">data</span>  <a href="#t:Password">Password</a> <ul class="subs"><li>= <a href="#v:ClearText">ClearText</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>  </li><li>| <a href="#v:Encrypted">Encrypted</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a>  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:AuthFailure">AuthFailure</a> <ul class="subs"><li>= <a href="#v:AuthError">AuthError</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a>  </li><li>| <a href="#v:BackendError">BackendError</a>  </li><li>| <a href="#v:DuplicateLogin">DuplicateLogin</a>  </li><li>| <a href="#v:EncryptedPassword">EncryptedPassword</a>  </li><li>| <a href="#v:IncorrectPassword">IncorrectPassword</a>  </li><li>| <a href="#v:LockedOut">LockedOut</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a>  </li><li>| <a href="#v:PasswordMissing">PasswordMissing</a>  </li><li>| <a href="#v:UsernameMissing">UsernameMissing</a>  </li><li>| <a href="#v:UserNotFound">UserNotFound</a>  </li></ul></li><li class="src short"><span class="keyword">data</span>  <a href="#t:Role">Role</a>  = <a href="#v:Role">Role</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:authSettingsFromConfig">authSettingsFromConfig</a> ::  <a href="Snap-Snaplet.html#t:Initializer">Initializer</a> b v <a href="Snap-Snaplet-Auth.html#t:AuthSettings">AuthSettings</a></li><li class="src short"><a href="#v:withBackend">withBackend</a> ::  (<span class="keyword">forall</span> r. <a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> r =&gt; r -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> v) a) -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> v) a</li><li class="src short"><a href="#v:encryptPassword">encryptPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></li><li class="src short"><a href="#v:checkPassword">checkPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:authenticatePassword">authenticatePassword</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></li><li class="src short"><a href="#v:setPassword">setPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></li><li class="src short"><a href="#v:encrypt">encrypt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></li><li class="src short"><a href="#v:verify">verify</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:registerUser">registerUser</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</li><li class="src short"><a href="#v:loginUser">loginUser</a> ::  <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; (<a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()) -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) () -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</li><li class="src short"><a href="#v:logoutUser">logoutUser</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) () -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</li><li class="src short"><a href="#v:requireUser">requireUser</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a</li><li class="src short"><a href="#v:setPasswordResetToken">setPasswordResetToken</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a>)</li><li class="src short"><a href="#v:clearPasswordResetToken">clearPasswordResetToken</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:addAuthSplices">addAuthSplices</a> :: <a href="Snap-Snaplet-Heist.html#t:HasHeist">HasHeist</a> b =&gt; <a href="Snap-Snaplet.html#t:Snaplet">Snaplet</a> (<a href="Snap-Snaplet-HeistNoClass.html#t:Heist">Heist</a> b) -&gt; <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet.html#t:Initializer">Initializer</a> b v ()</li><li class="src short"><a href="#v:compiledAuthSplices">compiledAuthSplices</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="Snap-Snaplet-HeistNoClass.html#t:SnapletCSplice">SnapletCSplice</a> b)</li><li class="src short"><a href="#v:userCSplices">userCSplices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist.html#t:RuntimeSplice">RuntimeSplice</a> m <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-Compiled.html#t:Splice">Splice</a> m)</li><li class="src short"><a href="#v:userISplices">userISplices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-Interpreted.html#t:Splice">Splice</a> m)</li><li class="src short"><a href="#v:ifLoggedIn">ifLoggedIn</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</li><li class="src short"><a href="#v:ifLoggedOut">ifLoggedOut</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</li><li class="src short"><a href="#v:loggedInUser">loggedInUser</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</li></ul></div><div id="interface"><h1 id="g:1">Higher Level Handler Functions
</h1><div class="top"><p class="src"><a name="v:createUser" class="def">createUser</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></td><td class="doc"><p>Username
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Password
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create a new user from just a username and password
</p></div></div><div class="top"><p class="src"><a name="v:usernameExists" class="def">usernameExists</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></td><td class="doc"><p>The username to be checked
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Check whether a user with the given username exists.
</p></div></div><div class="top"><p class="src"><a name="v:saveUser" class="def">saveUser</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Create or update a given user
</p></div></div><div class="top"><p class="src"><a name="v:destroyUser" class="def">destroyUser</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</p><div class="doc"><p>Destroy the given user
</p></div></div><div class="top"><p class="src"><a name="v:loginByUsername" class="def">loginByUsername</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></td><td class="doc"><p>Username/login for user
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc"><p>Should be ClearText
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc"><p>Set remember token?
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Lookup a user by her username, check given password and perform login
</p></div></div><div class="top"><p class="src"><a name="v:loginByRememberToken" class="def">loginByRememberToken</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Remember user from the remember token if possible and perform login
</p></div></div><div class="top"><p class="src"><a name="v:forceLogin" class="def">forceLogin</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc"><p>An existing user, somehow looked up from db
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> ())</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Login and persist the given <code><a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></code> in the active session
</p><p>Meant to be used if you have other means of being sure that the person is
 who she says she is.
</p></div></div><div class="top"><p class="src"><a name="v:logout" class="def">logout</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</p><div class="doc"><p>Logout the active user
</p></div></div><div class="top"><p class="src"><a name="v:currentUser" class="def">currentUser</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Return the current user; trying to remember from cookie if possible.
</p></div></div><div class="top"><p class="src"><a name="v:isLoggedIn" class="def">isLoggedIn</a> ::  <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Convenience wrapper around <code>rememberUser</code> that returns a bool result
</p></div></div><h1 id="g:2">Lower Level Functions
</h1><div class="top"><p class="src"><a name="v:markAuthSuccess" class="def">markAuthSuccess</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Mutate an <code><a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></code>, marking successful authentication
</p><p>This will save the user to the backend.
</p></div></div><div class="top"><p class="src"><a name="v:markAuthFail" class="def">markAuthFail</a> ::  <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Mutate an <code><a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></code>, marking failed authentication
</p><p>This will save the user to the backend.
</p></div></div><div class="top"><p class="src"><a name="v:checkPasswordAndLogin" class="def">checkPasswordAndLogin</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc"><p>An existing user, somehow looked up from db
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc"><p>A ClearText password
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Authenticate and log the user into the current session if successful.
</p><p>This is a mid-level function exposed to allow roll-your-own ways of looking
 up a user from the database.
</p><p>This function will:
</p><ol><li> Check the password
</li><li> Login the user into the current session
</li><li> Mark success/failure of the authentication trial on the user record
</li></ol></div></div><h1 id="g:3">Types
</h1><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AuthManager" class="def">AuthManager</a> b </p><div class="doc"><p>Abstract data type holding all necessary information for auth operation
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><span class="keyword">forall</span> r . <a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> r =&gt; <a name="v:AuthManager" class="def">AuthManager</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:backend" class="def">backend</a> :: r</dt><dd class="doc"><p>Storage back-end
</p></dd><dt class="src"><a name="v:session" class="def">session</a> :: <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b <a href="Snap-Snaplet-Session-SessionManager.html#t:SessionManager">SessionManager</a></dt><dd class="doc"><p>A lens pointer to a SessionManager
</p></dd><dt class="src"><a name="v:activeUser" class="def">activeUser</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></dt><dd class="doc"><p>A per-request logged-in user cache
</p></dd><dt class="src"><a name="v:minPasswdLen" class="def">minPasswdLen</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Password length range
</p></dd><dt class="src"><a name="v:rememberCookieName" class="def">rememberCookieName</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></dt><dd class="doc"><p>Cookie name for the remember token
</p></dd><dt class="src"><a name="v:rememberPeriod" class="def">rememberPeriod</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Remember period in seconds. Defaults to 2 weeks.
</p></dd><dt class="src"><a name="v:siteKey" class="def">siteKey</a> :: <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/clientsession-0.9.0.3/html/Web-ClientSession.html#t:Key">Key</a></dt><dd class="doc"><p>A unique encryption key used to encrypt remember cookie
</p></dd><dt class="src"><a name="v:lockout" class="def">lockout</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a>)</dt><dd class="doc"><p>Lockout after x tries, re-allow entry after y seconds
</p></dd><dt class="src"><a name="v:randomNumberGenerator" class="def">randomNumberGenerator</a> :: <a href="Snap-Snaplet-Session-Common.html#t:RNG">RNG</a></dt><dd class="doc"><p>Random number generator
</p></dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:AuthManager" class="caption collapser" onclick="toggleSection('i:AuthManager')">Instances</p><div id="section.i:AuthManager" class="show"><table><tr><td class="src"><a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span>  <a name="t:IAuthBackend" class="def">IAuthBackend</a> r  <span class="keyword">where</span></p><div class="doc"><p>All storage backends need to implement this typeclass
</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:save" class="def">save</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><div class="doc"><p>Create or update the given <code><a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></code> record.  A <code><a href="Snap-Snaplet-Auth.html#v:userId">userId</a></code> of Nothing
 indicates that a new user should be created, otherwise the user
 information for that userId should be updated.
</p></div><p class="src"><a name="v:lookupByUserId" class="def">lookupByUserId</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><p class="src"><a name="v:lookupByLogin" class="def">lookupByLogin</a> :: r -&gt; <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><p class="src"><a name="v:lookupByRememberToken" class="def">lookupByRememberToken</a> :: r -&gt; <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</p><p class="src"><a name="v:destroy" class="def">destroy</a> :: r -&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> ()</p></div><div class="subs instances"><p id="control.i:IAuthBackend" class="caption collapser" onclick="toggleSection('i:IAuthBackend')">Instances</p><div id="section.i:IAuthBackend" class="show"><table><tr><td class="src"><a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AuthSettings" class="def">AuthSettings</a>  </p><div class="doc"><p>Authentication settings defined at initialization time
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:AuthSettings" class="def">AuthSettings</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:asMinPasswdLen" class="def">asMinPasswdLen</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>Currently not used/checked
</p></dd><dt class="src"><a name="v:asRememberCookieName" class="def">asRememberCookieName</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></dt><dd class="doc"><p>Name of the desired remember cookie
</p></dd><dt class="src"><a name="v:asRememberPeriod" class="def">asRememberPeriod</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc"><p>How long to remember when the option is used in rest of the API.
 <code><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#v:Nothing">Nothing</a></code> means remember until end of session.
</p></dd><dt class="src"><a name="v:asLockout" class="def">asLockout</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a>, <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:NominalDiffTime">NominalDiffTime</a>)</dt><dd class="doc"><p>Lockout strategy: ([MaxAttempts], [LockoutDuration])
</p></dd><dt class="src"><a name="v:asSiteKey" class="def">asSiteKey</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:FilePath">FilePath</a></dt><dd class="doc"><p>Location of app's encryption key
</p></dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><a name="v:defAuthSettings" class="def">defAuthSettings</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthSettings">AuthSettings</a></p><div class="doc"><p>Default settings for Auth.
</p><pre> asMinPasswdLen = 8
 asRememberCookieName = &quot;_remember&quot;
 asRememberPeriod = Just (2*7*24*60*60) = 2 weeks
 asLockout = Nothing
 asSiteKey = &quot;site_key.txt&quot;
</pre></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AuthUser" class="def">AuthUser</a>  </p><div class="doc"><p>Type representing the concept of a User in your application.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:AuthUser" class="def">AuthUser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:userId" class="def">userId</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userLogin" class="def">userLogin</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userEmail" class="def">userEmail</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userPassword" class="def">userPassword</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userActivatedAt" class="def">userActivatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userSuspendedAt" class="def">userSuspendedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userRememberToken" class="def">userRememberToken</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userLoginCount" class="def">userLoginCount</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userFailedLoginCount" class="def">userFailedLoginCount</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Int.html#t:Int">Int</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userLockedOutUntil" class="def">userLockedOutUntil</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userCurrentLoginAt" class="def">userCurrentLoginAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userLastLoginAt" class="def">userLastLoginAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userCurrentLoginIp" class="def">userCurrentLoginIp</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userLastLoginIp" class="def">userLastLoginIp</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userCreatedAt" class="def">userCreatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userUpdatedAt" class="def">userUpdatedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userResetToken" class="def">userResetToken</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userResetRequestedAt" class="def">userResetRequestedAt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userRoles" class="def">userRoles</a> :: [<a href="Snap-Snaplet-Auth.html#t:Role">Role</a>]</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:userMeta" class="def">userMeta</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/unordered-containers-0.2.3.0/doc/html/Data-HashMap-Strict.html#t:HashMap">HashMap</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:Value">Value</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:AuthUser" class="caption collapser" onclick="toggleSection('i:AuthUser')">Instances</p><div id="section.i:AuthUser" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:defAuthUser" class="def">defAuthUser</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></p><div class="doc"><p>Default AuthUser that has all empty values.
</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span>  <a name="t:UserId" class="def">UserId</a>  </p><div class="doc"><p>Internal representation of a <code>User</code>. By convention, we demand that the
 application is able to directly fetch a <code>User</code> using this identifier.
</p><p>Think of this type as a secure, authenticated user. You should normally
 never see this type unless a user has been authenticated.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:UserId" class="def">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:unUid" class="def">unUid</a> :: <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a></dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div><div class="subs instances"><p id="control.i:UserId" class="caption collapser" onclick="toggleSection('i:UserId')">Instances</p><div id="section.i:UserId" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Read.html#t:Read">Read</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Haskell/ghc-7.6.3/lib/hashable-1.1.2.5/doc/html/Data-Hashable.html#t:Hashable">Hashable</a> <a href="Snap-Snaplet-Auth.html#t:UserId">UserId</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Password" class="def">Password</a>  </p><div class="doc"><p>Password is clear when supplied by the user and encrypted later when
 returned from the db.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:ClearText" class="def">ClearText</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Encrypted" class="def">Encrypted</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Password" class="caption collapser" onclick="toggleSection('i:Password')">Instances</p><div id="section.i:Password" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Read.html#t:Read">Read</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:AuthFailure" class="def">AuthFailure</a>  </p><div class="doc"><p>Authentication failures indicate what went wrong during authentication.
 They may provide useful information to the developer, although it is
 generally not advisable to show the user the exact details about why login
 failed.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:AuthError" class="def">AuthError</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-String.html#t:String">String</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:BackendError" class="def">BackendError</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:DuplicateLogin" class="def">DuplicateLogin</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:EncryptedPassword" class="def">EncryptedPassword</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:IncorrectPassword" class="def">IncorrectPassword</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:LockedOut" class="def">LockedOut</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/time-1.4.0.1/Data-Time-Clock.html#t:UTCTime">UTCTime</a></td><td class="doc"><p>Locked out until given time
</p></td></tr><tr><td class="src"><a name="v:PasswordMissing" class="def">PasswordMissing</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:UsernameMissing" class="def">UsernameMissing</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:UserNotFound" class="def">UserNotFound</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:AuthFailure" class="caption collapser" onclick="toggleSection('i:AuthFailure')">Instances</p><div id="section.i:AuthFailure" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Read.html#t:Read">Read</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Typeable-Internal.html#t:Typeable">Typeable</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">data</span>  <a name="t:Role" class="def">Role</a>  </p><div class="doc"><p>This will be replaced by a role-based permission system.
</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Role" class="def">Role</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Role" class="caption collapser" onclick="toggleSection('i:Role')">Instances</p><div id="section.i:Role" class="show"><table><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Eq.html#t:Eq">Eq</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Ord.html#t:Ord">Ord</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Read.html#t:Read">Read</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Text-Show.html#t:Show">Show</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:ToJSON">ToJSON</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/aeson-0.7.0.6/html/Data-Aeson-Types.html#t:FromJSON">FromJSON</a> <a href="Snap-Snaplet-Auth.html#t:Role">Role</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:4">Other Utilities
</h1><div class="top"><p class="src"><a name="v:authSettingsFromConfig" class="def">authSettingsFromConfig</a> ::  <a href="Snap-Snaplet.html#t:Initializer">Initializer</a> b v <a href="Snap-Snaplet-Auth.html#t:AuthSettings">AuthSettings</a></p><div class="doc"><p>Function to get auth settings from a config file.  This function can be
 used by the authors of auth snaplet backends in the initializer to let the
 user configure the auth snaplet from a config file.  All options are
 optional and default to what's in defAuthSettings if not supplied.
 Here's what the default options would look like in the config file:
</p><pre> minPasswordLen = 8
 rememberCookie = &quot;_remember&quot;
 rememberPeriod = 1209600 # 2 weeks
 lockout = [5, 86400] # 5 attempts locks you out for 86400 seconds
 siteKey = &quot;site_key.txt&quot;
</pre></div></div><div class="top"><p class="src"><a name="v:withBackend" class="def">withBackend</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<span class="keyword">forall</span> r. <a href="Snap-Snaplet-Auth.html#t:IAuthBackend">IAuthBackend</a> r =&gt; r -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> v) a)</td><td class="doc"><p>The function to run with the handler.
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> v) a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Run a function on the backend, and return the result.
</p><p>This uses an existential type so that the backend type doesn't
 <code>escape</code> AuthManager.  The reason that the type is Handler b
 (AuthManager v) a and not a is because anything that uses the
 backend will return an IO something, which you can liftIO, or a
 Handler b (AuthManager v) a if it uses other handler things.
</p></div></div><div class="top"><p class="src"><a name="v:encryptPassword" class="def">encryptPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></p><div class="doc"><p>Turn a <code><a href="Snap-Snaplet-Auth.html#v:ClearText">ClearText</a></code> password into an <code><a href="Snap-Snaplet-Auth.html#v:Encrypted">Encrypted</a></code> password, ready to
 be stuffed into a database.
</p></div></div><div class="top"><p class="src"><a name="v:checkPassword" class="def">checkPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></p></div><div class="top"><p class="src"><a name="v:authenticatePassword" class="def">authenticatePassword</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></td><td class="doc"><p>Looked up from the back-end
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet-Auth.html#t:Password">Password</a></td><td class="doc"><p>Check against this password
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Check password for a given user.
</p><p>Returns <a href="Nothing.html">Nothing</a> if check is successful and an <a href="IncorrectPassword.html">IncorrectPassword</a> error
 otherwise
</p></div></div><div class="top"><p class="src"><a name="v:setPassword" class="def">setPassword</a> :: <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></p><div class="doc"><p>Set a new password for the given user. Given password should be
 clear-text; it will be encrypted into a <code><a href="Snap-Snaplet-Auth.html#v:Encrypted">Encrypted</a></code>.
</p></div></div><div class="top"><p class="src"><a name="v:encrypt" class="def">encrypt</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a> -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/System-IO.html#t:IO">IO</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></p><div class="doc"><p>The underlying encryption function, in case you need it for
 external processing.
</p></div></div><div class="top"><p class="src"><a name="v:verify" class="def">verify</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Cleartext
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Encrypted reference
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>The underlying verify function, in case you need it for external
 processing.
</p></div></div><h1 id="g:5">Handlers
</h1><div class="top"><p class="src"><a name="v:registerUser" class="def">registerUser</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Login field
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Password field
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Either.html#t:Either">Either</a> <a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register a new user by specifying login and password <code>Param</code> fields
</p></div></div><div class="top"><p class="src"><a name="v:loginUser" class="def">loginUser</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Username field
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Password field
</p></td></tr><tr><td class="src">-&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/bytestring-0.10.0.2/Data-ByteString.html#t:ByteString">ByteString</a></td><td class="doc"><p>Remember field; Nothing if you want no remember function.
</p></td></tr><tr><td class="src">-&gt; (<a href="Snap-Snaplet-Auth.html#t:AuthFailure">AuthFailure</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ())</td><td class="doc"><p>Upon failure
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</td><td class="doc"><p>Upon success
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>A <code><a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/snap-core-0.9.6.3/html/Snap-Core.html#t:MonadSnap">MonadSnap</a></code> handler that processes a login form.
</p><p>The request paremeters are passed to <code>performLogin</code>
</p><p>To make your users stay logged in for longer than the session replay
 prevention timeout, you must pass a field name as the third parameter and
 that field must be set to a value of &quot;1&quot; by the submitting form.  This
 lets you use a user selectable check box.  Or if you want user remembering
 always turned on, you can use a hidden form field.
</p></div></div><div class="top"><p class="src"><a name="v:logoutUser" class="def">logoutUser</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</td><td class="doc"><p>What to do after logging out
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Simple handler to log the user out. Deletes user from session.
</p></div></div><div class="top"><p class="src"><a name="v:requireUser" class="def">requireUser</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b)</td><td class="doc"><p>Lens reference to an <a href="AuthManager.html">AuthManager</a>
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a</td><td class="doc"><p>Do this if no authenticated user is present.
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a</td><td class="doc"><p>Do this if an authenticated user is present.
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b v a</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Require that an authenticated <code><a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a></code> is present in the current
 session.
</p><p>This function has no DB cost - only checks to see if a user_id is present
 in the current session.
</p></div></div><div class="top"><p class="src"><a name="v:setPasswordResetToken" class="def">setPasswordResetToken</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Maybe.html#t:Maybe">Maybe</a> <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a>)</p><div class="doc"><p>This function generates a random password reset token and stores it in
 the database for the user.  Call this function when a user forgets their
 password.  Then use the token to autogenerate a link that the user can
 visit to reset their password.  This function also sets a timestamp so the
 reset token can be expired.
</p></div></div><div class="top"><p class="src"><a name="v:clearPasswordResetToken" class="def">clearPasswordResetToken</a> ::  <a href="file:///Library/Haskell/ghc-7.6.3/lib/text-0.11.3.1/doc/html/Data-Text-Internal.html#t:Text">Text</a> -&gt; <a href="Snap-Snaplet.html#t:Handler">Handler</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Clears a user's password reset token.  Call this when the user
 successfully changes their password to ensure that the password reset link
 cannot be used again.
</p></div></div><h1 id="g:6">Splice helpers
</h1><div class="top"><p class="src"><a name="v:addAuthSplices" class="def">addAuthSplices</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Snap-Snaplet-Heist.html#t:HasHeist">HasHeist</a> b</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Snap-Snaplet.html#t:Snaplet">Snaplet</a> (<a href="Snap-Snaplet-HeistNoClass.html#t:Heist">Heist</a> b)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b)</td><td class="doc"><p>A lens reference to <code><a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a></code>
</p></td></tr><tr><td class="src">-&gt; <a href="Snap-Snaplet.html#t:Initializer">Initializer</a> b v ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Add all standard auth splices to a Heist-enabled application.
</p><p>This adds the following splices:
 &lt;ifLoggedIn&gt;
 &lt;ifLoggedOut&gt;
 &lt;loggedInUser&gt;
</p></div></div><div class="top"><p class="src"><a name="v:compiledAuthSplices" class="def">compiledAuthSplices</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="Snap-Snaplet-HeistNoClass.html#t:SnapletCSplice">SnapletCSplice</a> b)</p><div class="doc"><p>List containing compiled splices for ifLoggedIn, ifLoggedOut, and
 loggedInUser.
</p></div></div><div class="top"><p class="src"><a name="v:userCSplices" class="def">userCSplices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist.html#t:RuntimeSplice">RuntimeSplice</a> m <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-Compiled.html#t:Splice">Splice</a> m)</p><div class="doc"><p>Compiled splices for AuthUser.
</p></div></div><div class="top"><p class="src"><a name="v:userISplices" class="def">userISplices</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.6.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.6.0.1/Control-Monad.html#t:Monad">Monad</a> m =&gt; <a href="Snap-Snaplet-Auth.html#t:AuthUser">AuthUser</a> -&gt; <a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-SpliceAPI.html#t:Splices">Splices</a> (<a href="file:///Users/wfreeman/neo4j-cypher-ex/.cabal-sandbox/share/doc/x86_64-osx-ghc-7.6.3/heist-0.13.1.2/html/Heist-Interpreted.html#t:Splice">Splice</a> m)</p><div class="doc"><p>Function to generate interpreted splices from an AuthUser.
</p></div></div><div class="top"><p class="src"><a name="v:ifLoggedIn" class="def">ifLoggedIn</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</p><div class="doc"><p>A splice that can be used to check for existence of a user. If a user is
 present, this will run the contents of the node.
</p><pre> &lt;ifLoggedIn&gt; Show this when there is a logged in user &lt;/ifLoggedIn&gt;
</pre></div></div><div class="top"><p class="src"><a name="v:ifLoggedOut" class="def">ifLoggedOut</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</p><div class="doc"><p>A splice that can be used to check for absence of a user. If a user is
 not present, this will run the contents of the node.
</p><pre> &lt;ifLoggedOut&gt; Show this when there is a logged in user &lt;/ifLoggedOut&gt;
</pre></div></div><div class="top"><p class="src"><a name="v:loggedInUser" class="def">loggedInUser</a> ::  <a href="Snap-Snaplet.html#t:SnapletLens">SnapletLens</a> b (<a href="Snap-Snaplet-Auth.html#t:AuthManager">AuthManager</a> b) -&gt; <a href="Snap-Snaplet-HeistNoClass.html#t:SnapletISplice">SnapletISplice</a> b</p><div class="doc"><p>A splice that will simply print the current user's login, if
 there is one.
</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.13.2</p></div></body></html>